{{ 'component-quick-view-modal.css' | asset_url | stylesheet_tag }}

{%- assign current_variant = product.selected_or_first_available_variant -%}

<div class="quick-view__modal-wrapper">
  <div class="quick-view__modal">
    <button class="quick-view__modal-close">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18" fill="none">
        <path d="M5.03784 4.94354L13.5231 13.4288" stroke="currentColor" stroke-width="1.5" stroke-linecap="square" stroke-linejoin="round"></path>
        <path d="M5.03784 13.4285L13.5231 4.94325" stroke="currentColor" stroke-width="1.5" stroke-linecap="square" stroke-linejoin="round"></path>
      </svg>
    </button>
    <div class="quick-view__product">
      <div class="quick-view__product-image media">
        {{ product.featured_media.preview_image | image_url: width: 240 | image_tag: loading: 'lazy' }}
      </div>
      <div class="quick-view__product-details">
        <h2 class="quick-view__product-title">{{ product.title }}</h2>
        <div class="quick-view__product-price">
          <span>{{ current_variant.price | money }}</span>
          {%- if current_variant.compare_at_price > current_variant.price -%}
            <s>{{ current_variant.compare_at_price | money }}</s>
          {%- endif -%}
        </div>
        {%- if product.description != blank -%}
          <div class="quick-view__product-desc rte">
            {{ product.description }}
          </div>
        {%- endif -%}
      </div>
    </div>
    <quick-product-form class="quick-view__product-form">
      {%- unless product.has_only_default_variant -%}
        <quick-variant-selects class="quick-view__product-options">
          {%- for option in product.options_with_values -%}
            {%- assign option_name_downcase = option.name | downcase -%}
            {%- if option_name_downcase contains 'color' or option_name_downcase contains 'colour' -%}
              <fieldset class="quick-view__product-option">
                <legend class="quick-view__option-name">{{ option.name }}</legend>
                <div class="quick-view__option-colors">
                  {%- for value in option.values -%}
                    {%- capture input_id -%}{{ option.name | handleize }}-{{ section.id }}-{{ forloop.index }}{%- endcapture -%}
                    <input 
                      type="radio"
                      name="{{ option.name }}"
                      id="{{ input_id }}"
                      class="quick-view__options-input visually-hidden"
                      value="{{ value }}"
                    >
                    <label for="{{ input_id }}">
                      <span class="color" style="background-color: {{ value }};"></span>
                      <span class="text">{{ value }}</span>
                    </label>
                  {%- endfor -%}
                </div>
              </fieldset>
            {%- else -%}
              <div class="quick-view__product-option">
                <div class="quick-view__option-name">{{ option.name }}</div>
                <div class="quick-view__option-select">
                  <div class="quick-view__option-select-label">Choose your size</div>
                  <div class="quick-view__option-select-list">
                    {%- for value in option.values -%}
                    {%- capture input_id -%}{{ option.name | handleize }}-{{ section.id }}-{{ forloop.index }}{%- endcapture -%}
                      <input 
                        type="radio"
                        name="{{ option.name }}"
                        id="{{ input_id }}"
                        class="quick-view__options-input visually-hidden"
                        value="{{ value }}"
                      >
                      <label for="{{ input_id }}">
                        {{- value -}}
                      </label>
                    {%- endfor -%}
                  </div>
                </div>
              </div>
            {%- endif -%}
          {%- endfor -%}
        </quick-variant-selects>
      {%- endunless -%}
    </quick-product-form>
  </div>
</div>

<style>
  body {
    overflow: hidden;
  }

  .quick-view__modal-wrapper {
    opacity: 1;
    visibility: visible;
  }
</style>

{% schema %}
{
  "name": "Product quick view",
  "settings": []
}
{% endschema %}